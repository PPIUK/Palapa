{"version":3,"sources":["useIMGNormalizedSource.ts"],"names":["useIMGNormalizedSource","source","specifiedDimensions","cachedDimensions","provideEmbeddedHeaders","uri","headers","printWidth","current","width","undefined","printHeight","height"],"mappings":";;;;;;;AAAA;;AACA;;AAMe,SAASA,sBAAT,CAAgC;AAC7CC,EAAAA,MAD6C;AAE7CC,EAAAA;AAF6C,CAAhC,EAKZ;AACD,QAAMC,gBAAgB,GAAG,mBAAOD,mBAAP,CAAzB;AACA,QAAM;AAAEE,IAAAA;AAAF,MAA6B,0CAAnC;AACA,SAAO,oBAAQ,MAAM;AACnB,QAAIH,MAAM,CAACI,GAAP,IAAc,OAAOD,sBAAP,KAAkC,UAApD,EAAgE;AAAA;;AAC9D,YAAME,OAAO,GAAGF,sBAAsB,CAACH,MAAM,CAACI,GAAR,EAAa,KAAb,EAAoB;AACxDE,QAAAA,UAAU,EAAE,0BAAAJ,gBAAgB,CAACK,OAAjB,gFAA0BC,KAA1B,KAAmCC,SADS;AAExDC,QAAAA,WAAW,EAAE,2BAAAR,gBAAgB,CAACK,OAAjB,kFAA0BI,MAA1B,KAAoCF;AAFO,OAApB,CAAtC;;AAIA,UAAIJ,OAAJ,EAAa;AACX,eAAO;AACLA,UAAAA,OADK;AAEL,aAAGL;AAFE,SAAP;AAID;AACF;;AACD,WAAOA,MAAP;AACD,GAdM,EAcJ,CAACG,sBAAD,EAAyBH,MAAzB,CAdI,CAAP;AAeD","sourcesContent":["import { useMemo, useRef } from 'react';\nimport { useSharedProps } from '../context/SharedPropsProvider';\nimport {\n  IncompleteImageDimensions,\n  UseIMGElementStateProps\n} from './img-types';\n\nexport default function useIMGNormalizedSource({\n  source,\n  specifiedDimensions\n}: Pick<UseIMGElementStateProps, 'source'> & {\n  specifiedDimensions: IncompleteImageDimensions;\n}) {\n  const cachedDimensions = useRef(specifiedDimensions);\n  const { provideEmbeddedHeaders } = useSharedProps();\n  return useMemo(() => {\n    if (source.uri && typeof provideEmbeddedHeaders === 'function') {\n      const headers = provideEmbeddedHeaders(source.uri, 'img', {\n        printWidth: cachedDimensions.current?.width || undefined,\n        printHeight: cachedDimensions.current?.height || undefined\n      });\n      if (headers) {\n        return {\n          headers,\n          ...source\n        };\n      }\n    }\n    return source;\n  }, [provideEmbeddedHeaders, source]);\n}\n"]}